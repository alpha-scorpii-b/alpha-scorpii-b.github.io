---
layout: documentation
group: HEAD
---
<div id="top">{% comment %}<!-- do not remove this div, it is closed by doxygen! -->{% endcomment %}
<!-- Generated by Doxygen 1.8.3.1 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Using Urho3D as external library </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>This page shows how to create a new C++ project linking against Urho3D library as external library. There are two approaches to do this. The first approach uses Urho3D library directly from the Urho3D project build tree. The second approach uses Urho3D SDK installation. It is imperative to clean the CMake cache when changing from one approach to the other. You should also clean the cache when you change the path in the URHO3D_HOME environment variable.</p>
<p>First of all, structure your project similar to Urho3D project as below. Although this is not mandatory, it should increase the chance the CMake modules designed for Urho3D project also works out of the box for your project too. CMake and our CMake modules are case-sensitive. It is recommended that your project adheres to the same naming convention as Urho3D project uses, even when the filesystem in your host system is not case-sensitive.</p>
<div class="fragment"><div class="line">&lt;PROJECT_ROOT&gt;/</div>
<div class="line"> ├ bin/</div>
<div class="line"> │  ├ Data/</div>
<div class="line"> │  └ CoreData/</div>
<div class="line"> ├ CMake/</div>
<div class="line"> │  ├ Modules/</div>
<div class="line"> │  └ Toolchains/</div>
<div class="line"> ├ CMakeListst.txt</div>
<div class="line"> ├ *.cpp and *.h</div>
<div class="line"> └ *.bat or *.sh</div>
</div><!-- fragment --><p>The physical project root directory is also the logical project source tree in CMake terminology where your project main CMakeLists.txt should reside. The 'bin' directory should contain the 'Data' and 'CoreData' resource subdirs for your own assets. You may want to copy (or symlink) the 'CMake' subdir from Urho3D project root directory (or from Urho3D SDK installation, which can be found in the 'share/Urho3D/CMake') to your project root directory. You may also want to copy (or symlink) the build scripts from Urho3D project root directory (or from Urho3D SDK installation, which can be found in the 'share/Urho3D/Scripts') to your project root directory. Alternatively, you can add the Urho3D project root directory into the PATH environment variable in your host system in order to make the build scripts available everwhere. The build scripts work together with the Urho3D CMake modules to configure and generate your initial project build tree. Both out-of-source build tree (recommended) and non out-of-source build tree are supported. Note that when you configure your project (either via one of the build script or via cmake-gui), you can also pass most of the <a class="el" href="_building.html#Build_Options">Build options</a> supported by Urho3D project. In fact, you probably have to pass a compatible build options with the Urho3D library that you intend to use to avoid any conflict.</p>
<p>In your own project root directory, create a main CMakeLists.txt file and add the following lines: (replace MyProjectName and MyExecutableName with the actual names you want)</p>
<div class="fragment"><div class="line"><span class="preprocessor"># Set project name</span></div>
<div class="line"><span class="preprocessor"></span>project (MyProjectName)</div>
<div class="line"></div>
<div class="line"><span class="preprocessor"># Set minimum version</span></div>
<div class="line"><span class="preprocessor"></span>cmake_minimum_required (VERSION 2.8.6)</div>
<div class="line"></div>
<div class="line">if (COMMAND cmake_policy)</div>
<div class="line">    cmake_policy (SET CMP0003 NEW)</div>
<div class="line">    if (CMAKE_VERSION VERSION_GREATER 2.8.12 OR CMAKE_VERSION VERSION_EQUAL 2.8.12)</div>
<div class="line">        <span class="preprocessor"># INTERFACE_LINK_LIBRARIES defines the link interface</span></div>
<div class="line"><span class="preprocessor"></span>        cmake_policy (SET CMP0022 NEW)</div>
<div class="line">    endif ()</div>
<div class="line">    if (CMAKE_VERSION VERSION_GREATER 3.0.0 OR CMAKE_VERSION VERSION_EQUAL 3.0.0)</div>
<div class="line">        <span class="preprocessor"># Disallow use of the LOCATION target property - therefore we set to OLD as we still need it</span></div>
<div class="line"><span class="preprocessor"></span>        cmake_policy (SET CMP0026 OLD)</div>
<div class="line">        <span class="preprocessor"># MACOSX_RPATH is enabled by default</span></div>
<div class="line"><span class="preprocessor"></span>        cmake_policy (SET CMP0042 NEW)</div>
<div class="line">    endif ()</div>
<div class="line">endif ()</div>
<div class="line"></div>
<div class="line"><span class="preprocessor"># Set CMake modules search path</span></div>
<div class="line"><span class="preprocessor"></span><span class="keyword">set</span> (CMAKE_MODULE_PATH ${CMAKE_SOURCE_DIR}/CMake/Modules)</div>
<div class="line"></div>
<div class="line"># Include Urho3D Cmake common module</div>
<div class="line">include (Urho3D-CMake-common)</div>
<div class="line"></div>
<div class="line"><span class="preprocessor"># Find Urho3D library</span></div>
<div class="line"><span class="preprocessor"></span>find_package (Urho3D REQUIRED)</div>
<div class="line">include_directories (${URHO3D_INCLUDE_DIRS})</div>
<div class="line"></div>
<div class="line"># Define target name</div>
<div class="line"><span class="keyword">set</span> (TARGET_NAME MyExecutableName)</div>
<div class="line"></div>
<div class="line"><span class="preprocessor"># Define source files</span></div>
<div class="line"><span class="preprocessor"></span>define_source_files ()</div>
<div class="line"></div>
<div class="line"><span class="preprocessor"># Setup target with resource copying</span></div>
<div class="line"><span class="preprocessor">setup_main_executable ()</span></div>
</div><!-- fragment --><p>The CMAKE_MODULE_PATH is setup so that CMake can find the Urho3D-specific CMake modules provided by Urho3D project inside your own project. The Urho3D-CMake-common.cmake is the module where all the reusable commands and macros are defined. It also gives your project cross-platform build capability similar to Urho3D project.</p>
<p>When both Urho3D static and shared library are built and available in the Urho3D project's library output directory in its build tree, the FindUrho3D.cmake module has precedence to first select static library type over over shared library type. However, you can use URHO3D_LIB_TYPE build option to explicitly specify which Urho3D library type to be selected. When linking statically against Urho3D static library, Urho3D-CMake-common.cmake module automatically set "URHO3D_STATIC_DEFINE" compiler define for your project. This compiler define is crucial for static linking, especially on MSVC. If you do not use our CMake modules to configure your project then you have to ensure you manually set this compiler define in your project.</p>
<p>As described earlier there are two approaches on how to find the Urho3D library. The FindUrho3D.cmake module is designed not only able to find Urho3D library from the Urho3D SDK installation, but also from any Urho3D project build tree directly. When searching in Urho3D SDK installed in a system-wide default location then no additional variable need to be set. When searching in a non-default SDK installation or when searching in any Urho3D project build tree then the actual location need to be provided via URHO3D_HOME environment variable (set in the host system) or URHO3D_HOME build option (set using -D at command line or in cmake-gui).</p>
<p>The define_source_files() and setup_main_executable() are Urho3D-specific macros. The define_source_file() macro is a shorthand to glob all the source files in the current directory. It is equivalent to these commands:</p>
<div class="fragment"><div class="line">file (GLOB CPP_FILES *.cpp)</div>
<div class="line">file (GLOB H_FILES *.h)</div>
<div class="line"><span class="keyword">set</span> (SOURCE_FILES ${CPP_FILES} ${H_FILES})</div>
</div><!-- fragment --><p>The setup_main_executable() macro then uses SOURCE_FILES and TARGET_NAME variables to setup a new CMake target that would work on ALL platforms supported by Urho3D. Make sure both your project name and target name are not called 'Urho3D', as this name is reserved for Urho3D project only.</p>
<p>If you have prepared your new project as outlined above then you can use the <a class="el" href="_building.html#Build_Scripts">build instructions of Urho3D project</a> to build your own project.</p>
<h2><a class="anchor" id="FromSDKWithPkgConfig"></a>
Using pkg-config instead of CMake</h2>
<p>If for some reason you could not use CMake in your project, you could configure your project to compile and link against Urho3D library from SDK installation using 'pkg-config' tool with the help of 'Urho3D.pc' configuration file (which is installed as part of the SDK installation). If the Urho3D SDK is being installed into a local location (such as /usr/local) or a non-default location, then most likely you would need to specify PKG_CONFIG_PATH environment variable to point to the location of the configuration file for this to work. The 'Urho3D.pc' file contains important information on how to configure your compiler and linker correctly. You can use that information as a reference to configure your own project even when you do not use 'pkg-config' tool.</p>
<p>Below are a few invocation examples on a 64-bit RedHat-based distro with local installation:</p>
<div class="fragment"><div class="line"><span class="preprocessor"># To get installed Urho3D version</span></div>
<div class="line"><span class="preprocessor"></span>PKG_CONFIG_PATH=/usr/local/lib64/pkgconfig pkg-config --modversion Urho3D</div>
<div class="line"></div>
<div class="line"><span class="preprocessor"># To compile and link natively in one liner</span></div>
<div class="line"><span class="preprocessor"></span>c++ -o Urho3DPlayer Urho3DPlayer.cpp `PKG_CONFIG_PATH=/usr/local/lib64/pkgconfig pkg-config --cflags --libs Urho3D`</div>
<div class="line"></div>
<div class="line"><span class="preprocessor"># To compile and link natively but in separate steps</span></div>
<div class="line"><span class="preprocessor"></span>export PKG_CONFIG_PATH=/usr/local/lib64/pkgconfig</div>
<div class="line">c++ -c Urho3DPlayer.cpp `pkg-config --cflags Urho3D`</div>
<div class="line">c++ -o Urho3DPlayer Urho3DPlayer.o `pkg-config --libs Urho3D`</div>
<div class="line"></div>
<div class="line"><span class="preprocessor"># To cross-compile and link for Raspberry Pi platform</span></div>
<div class="line"><span class="preprocessor"></span>export CC=${RPI_PREFIX}-c++</div>
<div class="line">export PKG_CONFIG_SYSROOT_DIR=${RPI_SYSROOT}</div>
<div class="line">export PKG_CONFIG_PATH=${RPI_SYSROOT}/usr/local/lib/pkgconfig</div>
<div class="line">$CC -o Urho3DPlayer Urho3DPlayer.cpp `pkg-config --cflags --libs Urho3D`</div>
<div class="line"></div>
<div class="line"><span class="preprocessor"># To cross-compile and link for Windows platform using MinGW cross-compiler (in Debug configuration)</span></div>
<div class="line"><span class="preprocessor"></span>export CC=${MINGW_PREFIX}-c++</div>
<div class="line">export PKG_CONFIG_SYSROOT_DIR=${MINGW_SYSROOT}</div>
<div class="line">export PKG_CONFIG_PATH=${MINGW_SYSROOT}/usr/local/lib/pkgconfig</div>
<div class="line">$CC -o Urho3DPlayer_d.exe Urho3DPlayer.cpp `pkg-config --variable CFLAGS_DEBUG Urho3D` `pkg-config --cflags --libs Urho3D`</div>
</div><!-- fragment --><h2><a class="anchor" id="Scaffolding"></a>
Project scaffolding</h2>
<p>With <a href="https://rubygems.org/gems/rake">Rake</a> ruby gem installed, you can quickly setup all the above by simply using the 'scaffolding' rake task.</p>
<pre class="fragment">rake scaffolding dir=/path/to/new/project/root [project=Scaffolding] [target=Main]
</pre><p>As its name implies, this task just creates a basic project structure for your new project. You may also pass optional "project" and "target" parameters besides the "dir" parameter. Otherwise, you will get the default project name (Scaffolding) and target name (Main) in the main CMakeLists.txt. This task copies the Urho3DPlayer.cpp and Urho3DPlayer.h as placeholders for the source files. Normally, you should replace these two files with your own project source files before invoking one of the build scripts.</p>
<p>On Windows host system, this task requires privilege to create symlinks by using mklink command. The task would fail when the Windows user account does not have that privilege. We strongly advise you not to use "Administrator" account just for this purpose. Instead, grant your "normal" user account to have the privilege correctly.</p>
<p>WARNING: As of this writing, this rake scaffolding task does not yet create a complete new project suitable for Android platform. You need to supply the missing bits manually yourself for now.</p>
<p>The Ruby and Rake are not prerequisite software components for building Urho3D and your projects. However, if you are reading this section this far and that your host system actually already has them installed then you can take advantage of them by utilising the 'rake cmake' and 'rake make' tasks. The former configures and generates the build tree (by invoking one of our build scripts under the hood) and the latter builds the project in the generated build tree (by invoking 'cmake &ndash;build' command which in turns calls the respective build tools, such as 'make' or 'xcodebuild', or 'MSBuild.exe') at the convenient of your finger tips in a command line interface.</p>
<p>To configure and generate: </p>
<pre class="fragment">rake cmake [&lt;generator&gt;] [&lt;platform&gt;] [&lt;option&gt;=&lt;value&gt; [&lt;option&gt;=&lt;value&gt;]] [[&lt;platform&gt;_]build_tree=/path/to/build-tree] [fix_scm]
</pre><p>To build: </p>
<pre class="fragment">rake make [&lt;platform&gt;] [&lt;option&gt;=&lt;value&gt; [&lt;option&gt;=&lt;value&gt;]] [[&lt;platform&gt;_]build_tree=/path/to/build-tree] [numjobs=8] [clean_first] [unfilter]
</pre><p>The default &lt;generator&gt; when not specified is 'generic', which let CMake to detect and choose what generator is available in the host to use. The possible values are: 'codeblocks', 'eclipse', 'macosx', 'vs2008', 'vs2010', 'vs2012', 'vs2013'.</p>
<p>The default &lt;platform&gt; when not specified is 'native'. The possible values are: 'android', 'ios', 'mingw', 'rpi'. Naturally this influences the compiler toolchain being used in the generated build tree.</p>
<p>When using the 'rake cmake' task, the &lt;option&gt;=&lt;value&gt; pairs are optional build options supported by our build scripts as usual. However, the format here does not expect a leading '-D' for each pair. When using the 'rake make' task, the &lt;option&gt;=&lt;value&gt; pairs are optional build options supported by the respective build tools. For example on iOS platform using 'xcodebuild' build tool, one could pass the '-sdk' option as follows: 'rake make ios sdk=iphonesimulator'. Note the absense of leading '-' character in the example. To build a specific built-in target in the project, use the 'target' option, e.g. 'rake make target=install'. In a multi-config project, such as Xcode project or VS solution, use the 'config' option to choose which build configuration to use, e.g. 'rake make config=Release'. For Xcode project building using 'rake make' task, you may optional install the 'xcpretty' filter to address the verbosity of the 'xcodebuild' tool from its standard output stream. On the other hand, pass the 'unfiter' option to get the output from 'xcodebuild' tool unfiltered regardless. You can pass the 'clean_first' option to perform a clean build. The 'numjobs' option is only applicable for 'make' tool where it defaults to 8 when not specified explicitly.</p>
<p>Use the 'build_tree' option to set the path to the desired build tree location. When not specified then the build tree location would be defaulted to '../&lt;platform&gt;-Build', relative to the project root. To avoid repeating the customized build tree locations for each platform, you can set and export them as environment variables. The '&lt;platform_&gt;build_tree' option takes precedence over normal 'build_tree' option. For example with these commands below, the native and RPI build tree will be generated in the ~/custom-native-Build and ~/custom-rpi-Build, respectively, and then build from there.</p>
<div class="fragment"><div class="line">export native_build_tree=~/custom-native-Build rpi_build_tree=~/custom-rpi-Build</div>
<div class="line">rake cmake URHO3D_LUAJIT=1 &amp;&amp; rake make</div>
<div class="line">rake cmake rpi URHO3D_LUAJIT=1 &amp;&amp; rake make rpi</div>
</div><!-- fragment --><p>You can in fact set and export any other key/value pair build options as environment variables to avoid repeating yourself when invoking any of our Rake tasks. </p>
</div></div><!-- contents -->
