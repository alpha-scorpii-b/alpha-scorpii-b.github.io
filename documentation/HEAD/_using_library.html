---
layout: documentation
group: HEAD
---
<div id="top">{% comment %}<!-- do not remove this div, it is closed by doxygen! -->{% endcomment %}
<!-- Generated by Doxygen 1.8.3.1 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Using Urho3D as external library </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>This page shows how to create a new C++ project linking against Urho3D library as external library. There are two approaches to do this. It is imperative to clear the CMake cache when changing from one approach to the other. In fact, you also need to clear the cache when any of the environment variables required by the CMake build script below change its value.</p>
<p>First of all, structure your project similar to Urho3D project as below:</p>
<div class="fragment"><div class="line">PROJECT_ROOT/</div>
<div class="line"> ┝ Source/</div>
<div class="line"> ┝ Build/</div>
<div class="line"> ┝ Bin/</div>
<div class="line"> ┕ *.bat or *.sh</div>
</div><!-- fragment --><p>The Source/ directory is where your project CMakeLists.txt and all your source codes should reside. The Bin/ directory is where all the executables output will be generated. In order to run the executable in this directory, you need to copy (or symlink) the CoreData/ and Data/ directories from Urho3D project Bin/ directory (or from Urho3D SDK installation) to here. You may also want to copy (or symlink) the batch files or shell script files from Urho3D project root directory (or from Urho3D SDK installation) to your project root directory. The Build/ directory will be created automatically by the Urho3D CMake module that will be discussed shortly below. The *.bat or *.sh scripts work together with the module to create a so-called out-of-source build tree to keep the Source/ directory clean from intermediate build files. Note that when you invoke one the *.bat or *.sh script, you can pass most of the <a class="el" href="_building.html#Build_Options">build options</a> supported by Urho3D project. In fact, you probably have to pass the similar build options that you use when building the Urho3D library to avoid any conflict.</p>
<h2><a class="anchor" id="UsingLibraryFromProjectRootTree"></a>
From Urho3D project root tree</h2>
<p>This section assumes that you have already successfully build a static or shared library in the Urho3D project (separately from your own project). In order to find Urho3D library in Urho3D project library output directory, specify an environment variable called "URHO3D_HOME" which points to a Urho3D project root directory that you want to use (if you have more than one).</p>
<p>In your own project Source/ directory, create a new CMakeLists.txt file and add the following lines: (replace MyProjectName and MyExecutableName with the actual names you want)</p>
<div class="fragment"><div class="line"><span class="preprocessor"># Set project name</span></div>
<div class="line"><span class="preprocessor"></span>project (MyProjectName)</div>
<div class="line"></div>
<div class="line"><span class="preprocessor"># Set minimum version</span></div>
<div class="line"><span class="preprocessor"></span>cmake_minimum_required (VERSION 2.8.6)</div>
<div class="line"></div>
<div class="line">if (COMMAND cmake_policy)</div>
<div class="line">    cmake_policy (SET CMP0003 NEW)</div>
<div class="line">    if (CMAKE_VERSION VERSION_GREATER 2.8.12 OR CMAKE_VERSION VERSION_EQUAL 2.8.12)</div>
<div class="line">        cmake_policy (SET CMP0022 NEW) <span class="preprocessor"># INTERFACE_LINK_LIBRARIES defines the link interface</span></div>
<div class="line"><span class="preprocessor"></span>    endif ()</div>
<div class="line">    if (CMAKE_VERSION VERSION_GREATER 3.0.0 OR CMAKE_VERSION VERSION_EQUAL 3.0.0)</div>
<div class="line">        cmake_policy (SET CMP0026 OLD) <span class="preprocessor"># Disallow use of the LOCATION target property - therefore we set to OLD as we still need it</span></div>
<div class="line"><span class="preprocessor"></span>        cmake_policy (SET CMP0042 NEW) <span class="preprocessor"># MACOSX_RPATH is enabled by default</span></div>
<div class="line"><span class="preprocessor"></span>    endif ()</div>
<div class="line">endif ()</div>
<div class="line"></div>
<div class="line"><span class="preprocessor"># Set CMake modules search path</span></div>
<div class="line"><span class="preprocessor"></span><span class="keyword">set</span> (CMAKE_MODULE_PATH $ENV{URHO3D_HOME}/Source/CMake/Modules CACHE PATH <span class="stringliteral">&quot;Path to Urho3D-specific CMake modules&quot;</span>)</div>
<div class="line"></div>
<div class="line"># Include Urho3D Cmake common module</div>
<div class="line">include (Urho3D-CMake-common)</div>
<div class="line"></div>
<div class="line"><span class="preprocessor"># Find Urho3D library</span></div>
<div class="line"><span class="preprocessor"></span>find_package (Urho3D REQUIRED)</div>
<div class="line">include_directories (${URHO3D_INCLUDE_DIRS})</div>
<div class="line"></div>
<div class="line"># Define target name</div>
<div class="line"><span class="keyword">set</span> (TARGET_NAME MyExecutableName)</div>
<div class="line"></div>
<div class="line"><span class="preprocessor"># Define source files</span></div>
<div class="line"><span class="preprocessor"></span>define_source_files ()</div>
<div class="line"></div>
<div class="line"><span class="preprocessor"># Setup target with resource copying</span></div>
<div class="line"><span class="preprocessor">setup_main_executable ()</span></div>
</div><!-- fragment --><p>The CMAKE_MODULE_PATH is setup so that CMake can find the Urho3D-specific CMake modules provided by Urho3D project inside your own project. The Urho3D-CMake-common.cmake is the module where all the reusable commands and macros are defined. It also gives your project cross-platform build capability similar to Urho3D project.</p>
<p>When both Urho3D static and shared library are built and available in the Urho3D project's library output directory, the FindUrho3D.cmake module has precedence to first select static library type over over shared library type. However, you can use URHO3D_LIB_TYPE build option to explicitly specify which Urho3D library type to be selected. When linking statically against Urho3D static library, Urho3D-CMake-common.cmake module automatically set "URHO3D_STATIC_DEFINE" compiler define for your project. This compiler define is crucial for static linking, especially on MSVC.</p>
<p>The define_source_files() and setup_main_executable() are Urho3D-specific macros. The define_source_file() macro is a shorthand to glob all the source files in the current source directory. It is equivalent to these commands:</p>
<div class="fragment"><div class="line">file (GLOB CPP_FILES *.cpp)</div>
<div class="line">file (GLOB H_FILES *.h)</div>
<div class="line"><span class="keyword">set</span> (SOURCE_FILES ${CPP_FILES} ${H_FILES})</div>
</div><!-- fragment --><p>The setup_main_executable() macro then uses SOURCE_FILES and TARGET_NAME variables to setup a new CMake target that would work on ALL platforms supported by Urho3D. Make sure both your project name and target name are not called 'Urho3D', as this name is already reserved by Urho3D project.</p>
<h2><a class="anchor" id="FromSDK"></a>
From Urho3D SDK installation</h2>
<p>This section assumes that you have already installed Urho3D SDK into your system. If you have installed the SDK in a non-default location then you need to use "CMAKE_PREFIX_PATH" environment variable to specify the prefix path of the non-default installation location.</p>
<p>In your own project Source/ directory, create a new CMakeLists.txt file similar to the first approach but change the CMake module search path setup to read as follows on Windows platform:</p>
<div class="fragment"><div class="line"><span class="preprocessor"># Set CMake modules search path</span></div>
<div class="line"><span class="preprocessor">set (CMAKE_MODULE_PATH $ENV{CMAKE_PREFIX_PATH}/share/CMake/Modules CACHE PATH &quot;Path to Urho3D-specific CMake modules&quot;)</span></div>
</div><!-- fragment --><p>On non-Windows platform:</p>
<div class="fragment"><div class="line"><span class="preprocessor"># Set CMake modules search path</span></div>
<div class="line"><span class="preprocessor">set (CMAKE_MODULE_PATH $ENV{CMAKE_PREFIX_PATH}/share/Urho3D/CMake/Modules CACHE PATH &quot;Path to Urho3D-specific CMake modules&quot;)</span></div>
</div><!-- fragment --><h3><a class="anchor" id="FromSDKWithPkgConfig"></a>
Using pkg-config instead of CMake</h3>
<p>If for some reason you could not use CMake in your project, you could configure your project to compile and link against Urho3D library from SDK installation using 'pkg-config' tool with the help of Urho3D.pc configuration file (which is installed as part of the SDK installation). If the Urho3D SDK is being installed into a local location (such as /usr/local) or a non-default location, then most likely you would need to specify PKG_CONFIG_PATH environment variable to point to the location of the configuration file for this to work. Below are a few invocation examples on a 64-bit RedHat-based distro with local installation:</p>
<div class="fragment"><div class="line"><span class="preprocessor"># To get installed Urho3D version</span></div>
<div class="line"><span class="preprocessor"></span>PKG_CONFIG_PATH=/usr/local/lib64/pkgconfig pkg-config --modversion Urho3D</div>
<div class="line"></div>
<div class="line"><span class="preprocessor"># To compile and link natively in one liner</span></div>
<div class="line"><span class="preprocessor"></span>c++ -o Urho3DPlayer Urho3DPlayer.cpp `PKG_CONFIG_PATH=/usr/local/lib64/pkgconfig pkg-config --cflags --libs Urho3D`</div>
<div class="line"></div>
<div class="line"><span class="preprocessor"># To compile and link natively but in separate steps</span></div>
<div class="line"><span class="preprocessor"></span>export PKG_CONFIG_PATH=/usr/local/lib64/pkgconfig</div>
<div class="line">c++ -c Urho3DPlayer.cpp `pkg-config --cflags Urho3D`</div>
<div class="line">c++ -o Urho3DPlayer Urho3DPlayer.o `pkg-config --libs Urho3D`</div>
<div class="line"></div>
<div class="line"><span class="preprocessor"># To cross-compile and link for Raspberry Pi platform</span></div>
<div class="line"><span class="preprocessor"></span>export CC=${RASPI_TOOL}/arm-linux-gnueabihf-c++</div>
<div class="line">export PKG_CONFIG_SYSROOT_DIR=${RASPI_ROOT}</div>
<div class="line">export PKG_CONFIG_PATH=${RASPI_ROOT}/usr/local/lib/pkgconfig</div>
<div class="line">$CC -o Urho3DPlayer Urho3DPlayer.cpp `pkg-config --cflags --libs Urho3D`</div>
</div><!-- fragment --><h2><a class="anchor" id="Scaffolding"></a>
Project scaffolding</h2>
<p>On Unix-like build/host system (Linux, Mac, Raspberry-Pi) with <a href="https://rubygems.org/gems/rake">Rake</a> ruby gem installed, you can quickly setup all the above by simply using the 'scaffolding' rake task. </p>
<pre class="fragment">Usage: rake scaffolding dir=/path/to/new/project/root [project=Scaffolding] [target=Main]
</pre><p>As its name implies, this task just creates a basic project structure for your new project. You may also pass optional "project" and "target" parameters besides the "dir" parameter. Otherwise, you will get the default project name (Scaffolding) and target name (Main) in the main CMakeLists.txt. This task copies the Urho3DPlayer.cpp and Urho3DPlayer.h as placeholders for the source files. Normally, you should replace these two files with your own project source files before invoking one of the CMake *.bat or *.sh script.</p>
<p>Unfortunately, all our rake tasks are currently not supported on Windows build/host system yet. </p>
</div></div><!-- contents -->
